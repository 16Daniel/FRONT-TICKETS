<div class="text">REPORTES</div>

<div class="p-3">

    <div class="row ps-4 pe-4">
        <div class="col-md-3 p-3 p-0">
            <p>PUESTO DE TRABAJO</p>
            <p-dropdown 
              [options]="catdepartamentos" 
              [(ngModel)]="departamentosel" 
              optionLabel="name" 
              [filter]="true"
              filterBy="name" 
              placeholder="SELECCIONAR PUESTO DE TRABAJO" 
              (onChange)="getempleados()"
              [style]="{width:'100%'}"/>

        </div>
        <div class="col-md-3 p-3 pb-0">
            <p>EMPLEADO</p>
              <p-dropdown 
              [options]="catempleados" 
              [(ngModel)]="empleadosel" 
              optionLabel="nombre" 
              [filter]="true"
              filterBy="nombre" 
              placeholder="SELECCIONAR EMPLEADO"
              [style]="{width:'100%'}">
            
              <ng-template pTemplate="selectedItem" let-selectedOption>
            <div class="flex align-items-center gap-2">
                <div>{{ selectedOption.nombre + ' ' + selectedOption.apellidop + ' '+ selectedOption.apellidom }}</div>
            </div>
        </ng-template>
        <ng-template let-item pTemplate="item">
            <div class="flex align-items-center gap-2">
                <div>{{ item.nombre + ' ' + item.apellidop + ' '+ item.apellidom }}</div>
            </div>
        </ng-template>
      </p-dropdown>

        </div>

        <div class="col-auto p-3 pb-0">
        <p>FECHA INICIO</p>
        <p-calendar [(ngModel)]="fechaIni" [iconDisplay]="'input'" [showIcon]="true" inputId="icondisplay"
          [style]="{width:'100%'}" />
      </div>
      <div class="col-auto p-3 pb-0">
        <p>FECHA FIN</p>
        <p-calendar [(ngModel)]="fechaFin" [iconDisplay]="'input'" [showIcon]="true" inputId="icondisplay"
          [style]="{width:'100%'}" />
      </div>


        <div class="col-auto p-3 pb-0">
            <p>&nbsp;</p>
            <div class="d-flex justify-content-center mt-3">
                <button class="btn btn-dark p-2" (click)="consultar()"><i class='bx bx-search' ></i> CONSULTAR</button>
                </div>    
        </div>
    </div>


</div>

<div class="ps-4 pe-4 mt-3 mb-3 pb-3 mt-4">

  <div class="d-flex justify-content-center mt-4" *ngIf="loading">
     <div class="d-flex justify-content-center p-3" *ngIf="loading">
    <i class="bx bx-loader bx-lg bx-spin" style="color: rgb(0, 153, 255)"></i>
  </div>

  </div>

<div class="rounded-3 bg-white p-3" *ngIf="loading==false">
<h2 class="text-center" style="color: rgb(0, 87, 158);">{{nombreemp}}</h2>
<div class="p-1" style="background-color: #c7d0e2;">
<p class="text-center fs-3">{{getTotalHorasTrabajadas() | number:'1.2-2' }}&nbsp;HORAS DE TRABAJO</p>
</div>

  <div style="overflow: auto;" class="mt-3 p-3">

    <div class="p-3" *ngIf="tabledia.length>0">
      <app-grafica-horas-trabajo [data]="tabledia" [fechaIni]="fechaIni" [fechaFin]="fechaFin"></app-grafica-horas-trabajo>
    </div>
   
    <p-table [value]="tabledia" [tableStyle]="{ 'min-width': '50rem' }">
    <ng-template pTemplate="header">
        <tr style="text-align: center;">
            <th scope="col">SUCURSAL</th>
            <th scope="col">FECHA</th>
            <th scope="col">ENTRADA</th>
            <th scope="col">SALIDA</th>
            <th scope="col">ESTAD√çA(HRS)</th>
          </tr>
    </ng-template>
    <ng-template pTemplate="body" let-item>
        <tr style="text-align: center;" class="bg-opacity-25" [ngClass]="{'bg-danger': item.entrada == '' || item.salida ==''}">
            <td class="text-center">{{item.sucursal}}</td>
             <td class="text-center">{{item.fecha | date}}</td>
            <td class="text-center">{{item.entrada | date:'HH:mm' }}</td>
            <td class="text-center">{{item.salida | date:'HH:mm'}}</td>
            <td class="text-center">{{item.estadia | number:'1.2-2' }}</td>
          </tr>
    </ng-template>
</p-table>

  </div>


</div>
</div>

<p-toast [breakpoints]="{'920px': {width: '100%', right: '0', left: '0'}}" [showTransformOptions]="'translateY(100%)'" [showTransitionOptions]="'500ms'" [hideTransitionOptions]="'500ms'" [showTransformOptions]="'translateX(100%)'"></p-toast>
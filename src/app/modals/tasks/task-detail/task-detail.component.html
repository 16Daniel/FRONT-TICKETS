<p-dialog [header]="'DETALLE DE TAREA'" [(visible)]="mostrarModal" [modal]="true" [style]="{ 'width': '95vw', 'height': '95vh' }"
    [maximizable]="true" (onHide)="onHide()">

    <div class="d-flex gap-3" style="width: 100%; height: 75vh;">

        <div style="width: 60%; overflow-y: auto; padding-right: 10px;">

            <div class="d-flex justify-content-end mt-3">
                <button class="btn btn-primary" style="margin: 2px">
                    <i class="bx bx-message-square-dots bx-sm" style="color: rgb(255, 255, 255)" pTooltip="CHAT"
                        tooltipPosition="top"></i>
                </button>

                <button class="btn btn-primary" style="margin: 2px" (click)="abrirModalImagenes()">
                    <i class="bx bx-paperclip bx-sm" style="color: rgb(255, 255, 255)" pTooltip="VER IMÁGENES"
                        tooltipPosition="top"></i>
                </button>

                <button class="btn btn-primary" style="margin: 2px" (click)="mostrarModalSubirImagen = true">
                    <i class="bx bx-image-add bx-sm" style="color: white" pTooltip="SUBIR IMÁGEN"
                        tooltipPosition="top"></i>
                </button>
            </div>

            <form #form="ngForm" (ngSubmit)="enviar(form)">
                <div class="p-3">

                    <!-- ID / TÍTULO -->
                    <div class="mb-3">
                        <label class="fw-bold">TÍTULO</label>
                        <input [(ngModel)]="tarea.titulo" name="titulo" class="form-control"
                            placeholder="Título de la tarea">
                    </div>

                    <!-- SUCURSAL -->
                    <p class="fw-bold">SUCURSAL</p>
                    <p-dropdown [options]="sucursales" [(ngModel)]="tarea.idSucursal" name="sucursal"
                        [optionValue]="'id'" optionLabel="nombre" [filter]="true" filterBy="nombre" [showClear]="true"
                        placeholder="SELECCIONA SUCURSAL / DEPARTAMENTO" [style]="{width:'100%'}" required="true">
                    </p-dropdown>

                    <p></p>

                    <!-- CATEGORÍAS -->
                    <p class="fw-bold">CATEGORÍA</p>
                    <p-dropdown [options]="categorias" [(ngModel)]="tarea.idCategoria" name="categoria"
                        [optionValue]="'id'" optionLabel="nombre" [filter]="true" filterBy="nombre" [showClear]="true"
                        placeholder="SELECCIONA LA CATEGORÍA" [style]="{width:'100%'}" required="true">
                    </p-dropdown>

                    <p></p>

                    <!-- COMENTARIO RESPONSABLE -->
                    <div class="mb-3">
                        <label class="fw-bold">COMENTARIO RESPONSABLE</label>
                        <textarea [(ngModel)]="tarea.comentariosResponsable" name="comentarioResponsable"
                            class="form-control" rows="7">
                        </textarea>
                    </div>

                </div>

                <!-- BOTÓN GUARDAR -->
                <div class="d-flex justify-content-end mt-3">
                    <button class="btn bg-p-b p-3">
                        <i class='bx bx-send'></i>
                        <label>GUARDAR</label>
                    </button>
                </div>

            </form>
        </div>

        <div style="width: 40%; border-left: 1px solid #ddd; padding-left: 10px; overflow-y: auto;">
            <app-task-comment-box [tarea]="tarea"></app-task-comment-box>
        </div>

    </div>

</p-dialog>


<p-toast [breakpoints]="{'920px': {width: '100%', right: '0', left: '0'}}" [showTransformOptions]="'translateY(100%)'"
    [showTransitionOptions]="'500ms'" [hideTransitionOptions]="'500ms'"
    [showTransformOptions]="'translateX(100%)'"></p-toast>

<app-modal-visor-varias-imagenes *ngIf="mostrarModalVisorImagen" [mostrarModal]="mostrarModalVisorImagen"
    (closeEvent)="mostrarModalVisorImagen = false" [imagenes]="imagenes" [mostrarBotonEliminar]="true"
    (imagenEliminadaEvent)="onEliminarImagen($event)"></app-modal-visor-varias-imagenes>

<app-task-imguploader *ngIf="mostrarModalSubirImagen" [mostrarModal]="mostrarModalSubirImagen"
    (closeEvent)="mostrarModalSubirImagen = false" [tarea]="tarea"></app-task-imguploader>
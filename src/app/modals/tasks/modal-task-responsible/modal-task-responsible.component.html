<p-dialog header="CREAR RESPONSABLE" [modal]="true" [(visible)]="mostrarModal" [style]="{ width: '65vw' }"
  [breakpoints]="{ '1199px': '80vw', '575px': '95vw' }" [maximizable]="true" (onHide)="onHide()">

  <!-- FORMULARIO -->
  <form #f="ngForm" (ngSubmit)="enviar(f)">
    <div class="row align-items-center">

      <!-- NOMBRE -->
      <div class="col-md-4">
        <p class="fw-bold mb-1">NOMBRE</p>
        <input class="form-control" style="height: 48px" type="text" placeholder="NOMBRE DEL RESPONSABLE"
          [(ngModel)]="nuevoResponsable.nombre" name="nombre" required minlength="3" />
      </div>

      <!-- POSICIÓN -->
      <div class="col-md-4">
        <p class="fw-bold mb-1">POSICIÓN / PUESTO</p>
        <input class="form-control" style="height: 48px" type="text" placeholder="EJ. GERENTE, SUPERVISOR"
          [(ngModel)]="nuevoResponsable.posicion" name="posicion" required />
      </div>

      <!-- SUCURSAL -->
      <div class="col-md-4">
        <p class="fw-bold mb-1">SUCURSAL / DEPARTAMENTO</p>
        <p-dropdown [options]="sucursales" [(ngModel)]="nuevoResponsable.idSucursal" name="sucursal" optionValue="id"
          optionLabel="nombre" [filter]="true" [showClear]="true" placeholder="SELECCIONAR SUCURSAL"
          [style]="{ width: '100%' }" (onChange)="onSucursalChange($event.value)"></p-dropdown>
      </div>

      <!-- BOTÓN -->
      <div class="d-flex justify-content-end mt-3">
        <button pButton type="submit" label="Agregar" [disabled]="f.invalid || cargando"></button>
      </div>

    </div>
  </form>

  <!-- TABLA -->
  <div class="mt-4" style="min-height: 300px">
    <p-table [value]="responsables" [tableStyle]="{ 'min-width': '50rem' }">

      <ng-template pTemplate="header">
        <tr>
          <th>Nombre</th>
          <th>Posición</th>
          <th>Eliminar</th>
        </tr>
      </ng-template>

      <ng-template pTemplate="body" let-res>
        <tr>

          <!-- NOMBRE -->
          <td>
            <input type="text" class="form-control" [(ngModel)]="res.nombre" [readonly]="!res.editando"
              (click)="activarEdicion(res)" (blur)="guardarCambios(res)" (keydown.enter)="guardarCambios(res)" />
          </td>

          <!-- POSICIÓN -->
          <td>
            <input type="text" class="form-control" [(ngModel)]="res.posicion" [readonly]="!res.editando"
              (click)="activarEdicion(res)" (blur)="guardarCambios(res)" (keydown.enter)="guardarCambios(res)" />
          </td>

          <!-- ELIMINAR -->
          <td>
            <p-button icon="pi pi-trash" severity="danger" (onClick)="eliminar(res)"></p-button>
          </td>

        </tr>
      </ng-template>

    </p-table>
  </div>

</p-dialog>

<p-toast></p-toast>
